to_date = function(vec) {
  
  new_dates = c()
  for(i in 1:length(vec)) {
    new_date = substr(vec[i], start = 2, stop = nchar(vec[i]))
    substr(new_date, 5, 5) = "-"
    substr(new_date, 8, 8) = "-"
    new_date = as.Date(new_date, format = "%Y-%m-%d")
    new_dates[i] = as.character(new_date)
    
  }
  
  new_dates = as.Date(new_dates)
  return(new_dates)
  
}

data_list = function(d_casos, d_fallecimientos, d_altas, d_hospitalizados, d_uci) {
  
  # Primero, obtener la secuencia total de fechas para homogenizar los datos
  f_casos = d_casos[, c(ncol(d_casos))]
  f_altas = d_altas[, c(ncol(d_altas))]
  f_fallecidos = d_fallecimientos[, c(ncol(d_fallecimientos))]
  f_hospitalizados = d_hospitalizados[, c(ncol(d_hospitalizados))]
  f_uci = d_uci[, c(ncol(d_uci))]
  
  f_max = max(max(f_casos), max(f_altas), max(f_fallecidos), max(f_hospitalizados), max(f_uci))
  f_min = min(min(f_casos), min(f_altas), min(f_fallecidos), min(f_hospitalizados), min(f_uci))
  
  fechas = seq(f_min, f_max, 1)
  
  # Listado de comunidades
  comunidades = c("Andalucia", "Aragon", "Asturias", "Baleares", "Canarias", "Cantabria",
                  "Castilla La Mancha", "Castilla y Leon", "Cataluna", "Ceuta", "C.Valenciana",
                  "Extremadura", "Galicia", "Madrid", "Melilla", "Murcia", "Navarra", "Pais Vasco",
                  "La Rioja", "Total")
  
  # Creaci√≥n de la lista de datasets 
  dnew_list = list()
  for(k in 1:length(comunidades)) {
    d_c = d_casos[, c(k, ncol(d_casos))]
    d_a = d_altas[, c(k, ncol(d_altas))]
    d_f = d_fallecimientos[, c(k, ncol(d_fallecimientos))]
    d_h = d_hospitalizados[, c(k, ncol(d_hospitalizados))]
    d_u = d_uci[, c(k, ncol(d_uci))]
    
    dataset = cbind.data.frame(fechas)
    vec_casos = c()
    vec_altas = c()
    vec_fallecimientos = c()
    vec_uci = c()
    vec_hospitalizados = c()
    for(i in 1:length(fechas)) {
      for(ci in 1:nrow(d_c)) {
        if(fechas[i] == d_c[ci, 2]) {
          vec_casos[i] <- d_c[ci, 1]
          
        }
        
      }
      
      for(ai in 1:nrow(d_a)) {
        if(fechas[i] == d_a[ai, 2]) {
          vec_altas[i] <- d_a[ai, 1]
          
        }
        
      }
      
      for(fi in 1:nrow(d_f)) {
        if(fechas[i] == d_f[fi, 2]) {
          vec_fallecimientos[i] <- d_f[fi, 1]
          
        }
        
      }
      
      for(ui in 1:nrow(d_u)) {
        if(fechas[i] == d_u[ui, 2]) {
          vec_uci[i] <- d_u[ui, 1]
          
        }
        
      }
      
      for(hi in 1:nrow(d_h)) {
        if(fechas[i] == d_h[hi, 2]) {
          vec_hospitalizados[i] <- d_h[hi, 1]
          
        }
        
      }
      
    }
    
    dataset = cbind.data.frame("Fecha" = fechas,
                               "Casos" = vec_casos, 
                               "Fallecidos" = vec_fallecimientos,
                               "Altas" = vec_altas,
                               "Hospitalizados" = vec_hospitalizados,
                               "UCI" = vec_uci)
    
    dnew_list[[k]] <- dataset
    
  }
  
  names(dnew_list) = comunidades
  return(dnew_list)
  
}